<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Happy Birthday Vaishnavi üéâ</title>
    <!-- Fancy fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Roboto+Slab:wght@400;600&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root { --text-stroke: 0.6px rgba(0,0,0,0.24); }
        /* apply a default stroke to main text elements for a bolder look */
        h1, h2, button, p, a, .song-row .meta .title, .song-row .meta .artist, .song-row .rank, #secretMessage { -webkit-text-stroke: var(--text-stroke); }

        body {
            margin: 0;
            font-family: Poppins, sans-serif;
            /* richer layered background */
            background: radial-gradient(circle at 10% 10%, rgba(255,250,240,0.18), transparent 12%),
                        linear-gradient(135deg, #ff6fb5 0%, #ffd36e 40%, #7ee8fa 100%);
            color: #fff;
            text-align: center;
            overflow: hidden;
            position: relative;
        }
        /* Typography enhancements */
        h1 {
            font-family: 'Playfair Display', serif;
            font-size: 42px;
            font-weight: 800;
            letter-spacing: 0.6px;
            /* brighter clipped gradient with subtle stroke */
            background: linear-gradient(90deg, #fff8e6 0%, #ffd6e0 40%, #ff9ac2 100%);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            /* use variable stroke */
            -webkit-text-stroke: var(--text-stroke);
            text-shadow: 0 4px 14px rgba(0,0,0,0.22);
            margin: 6px 0 4px;
        }
        h2 {
            font-family: 'Poppins', sans-serif;
            font-weight: 700;
            font-size: 18px;
            color: rgba(255,255,255,0.95);
            text-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }
        /* Button style tweak */
        button {
            font-family: 'Poppins', sans-serif;
            box-shadow: 0 8px 22px rgba(0,0,0,0.22);
            backdrop-filter: blur(6px);
            background: linear-gradient(90deg,#ff7aa2,#ffb86b);
            border: 1px solid rgba(255,255,255,0.12);
        }
        /* Song title styling */
        .song-row .meta .title {
            font-family: 'Roboto Slab', serif;
            color: #fff;
            text-shadow: 0 2px 6px rgba(0,0,0,0.45);
            -webkit-text-stroke: var(--text-stroke);
        }
        .song-row .meta .artist { font-family: 'Poppins', sans-serif; -webkit-text-stroke: var(--text-stroke); }
        /* Secret message styling */
        #secretMessage {
            font-family: 'Playfair Display', serif;
            font-size: 20px;
            background: linear-gradient(90deg, rgba(255,255,255,0.14), rgba(255,255,255,0.06));
            border: 1px solid rgba(255,255,255,0.12);
            transform: translateY(20px);
            transition: transform 0.35s ease, opacity 0.35s ease;
        }
        #secretMessage.show { transform: translateY(0); opacity: 1; }
        .page {
            display: none;
            height: 100vh;
            padding: 20px;
            box-sizing: border-box;
            opacity: 0;
            transition: opacity 0.8s ease-in-out;
        }
        .active {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            opacity: 1;
        }
        img {
            max-width: 90%;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.25);
            margin: 12px 0;
        }
        button {
            background: #ff6f91;
            border: none;
            padding: 12px 22px;
            border-radius: 28px;
            color: #fff;
            font-size: 16px;
            cursor: pointer;
            margin-top: 14px;
            transition: transform 0.2s ease;
        }
        button:hover {
            transform: scale(1.05);
        }
        /* play button removed: autoplay is used instead */

        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-5px); }
            100% { transform: translateY(0px); }
        }
        .gif-float {
            animation: float 4s infinite;
        }

        /* Floating GIFs styles (improved) */
        .floating-gifs {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            overflow: visible;
            z-index: 9999; /* bring GIFs well above page content */
        }
        .floating-gifs .gif1,
        .floating-gifs .gif2,
        .floating-gifs .gif3 {
            position: fixed; /* fixed so GIFs stay relative to viewport */
            width: 80px;
            will-change: transform, bottom, opacity;
            pointer-events: none; /* ensure GIFs don't block clicks */
            mix-blend-mode: screen;
            /* upward float (bottom) + subtle bob (transform) */
            animation: floatGifUp 16s linear infinite, float 4s ease-in-out infinite;
        }
        /* start near bottom so they float up into view; stagger timings & durations */
        .floating-gifs .gif1 { left: 8%; bottom: -8%; animation-delay: 0s; animation-duration: 14s, 4s; }
        .floating-gifs .gif2 { left: 48%; bottom: -6%; animation-delay: 3s; animation-duration: 17s, 4s; }
        .floating-gifs .gif3 { left: 85%; bottom: -10%; animation-delay: 6s; animation-duration: 19s, 4s; }

        @keyframes floatGifUp {
            0% { bottom: -18vh; transform: translateX(0) rotate(0deg) scale(1); opacity: 0.98; }
            25% { bottom: 10vh; transform: translateX(18px) rotate(-4deg) scale(1.02); opacity: 1; }
            50% { bottom: 50vh; transform: translateX(-12px) rotate(4deg) scale(1); opacity: 0.92; }
            75% { bottom: 90vh; transform: translateX(10px) rotate(-2deg) scale(0.98); opacity: 0.88; }
            100% { bottom: 130vh; transform: translateX(0) rotate(0deg) scale(1); opacity: 0.82; }
        }

        /* Floating hearts / sparkles */
        .heart {
            position: fixed;
            color: #ffb6c1;
            font-size: 20px;
            pointer-events: none;
            animation: floatHeartUp 4s linear infinite;
        }
        @keyframes floatHeartUp {
            0% { transform: translateY(0) scale(1); opacity: 1; }
            100% { transform: translateY(-100vh) scale(1.5); opacity: 0; }
        }

        /* Per-page backgrounds to make each section distinct */
    #page1 { background: radial-gradient(circle at 20% 20%, rgba(255,240,230,0.14), transparent 12%), linear-gradient(135deg, #ff9ab3 0%, #ff6f91 40%, #8ad9ff 100%); }
    #page2 { background: linear-gradient(120deg, rgba(255,245,240,0.06), rgba(255,230,240,0.02)), linear-gradient(120deg,#f6d365,#fda085); }
    #page3 { background: linear-gradient(180deg, rgba(240,250,255,0.03), rgba(220,235,255,0.01)), linear-gradient(135deg,#c9ffbf,#ffafbd); }
    #page4 { background: linear-gradient(180deg, rgba(10,10,20,0.15), rgba(20,10,30,0.06)), linear-gradient(135deg,#7ee8fa,#ffd36e); }
    #page5 { background: linear-gradient(180deg, rgba(255,250,240,0.06), rgba(255,240,250,0.02)), linear-gradient(135deg,#fbc2eb,#a6c1ee); }
    #page6 { background: linear-gradient(180deg, rgba(20,10,30,0.08), rgba(10,5,15,0.02)), linear-gradient(135deg,#ffd36e,#ff9ab3); }
    #page2 img { max-width: 76.5%; }
    #page2 h1 {
    font-size: 18px; /* Reduce from default 42px to fit better */
    margin: 4px 0 2px; /* Tighter margins */
    }
    #page2 h2 {
        font-size: 14px; /* Reduce from default 18px */
        margin-top: 4px; /* Less top margin */
    }
    #page2 img {
        max-width: 70%; /* Reduce from 76.5% to leave more space */
        margin: 8px 0; /* Reduce from 12px 0 */
    }
    #page2 button {
        margin-top: 8px; /* Reduce from 14px to pull button closer */
        padding: 10px 18px; /* Keep existing, but ensure it's not oversized */
    }
        #page5.active {
        transform: translateY(-50px);
        }


        /* Ensure Note page text is highly readable on pastel background */
        #page3 h1, #page3 p {
            color: #07282b; /* deep teal for contrast */
            -webkit-text-stroke: 0.6px rgba(255,255,255,0.85);
            text-shadow: 0 2px 6px rgba(255,255,255,0.6);
        }

        /* Intro page hero styles */
        #page1 h1 {
            font-size: 62px;
            line-height: 1.02;
            margin: 0 0 6px;
            background: linear-gradient(90deg,#fffaf0,#ffd6e0,#ffd36e);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 8px 30px rgba(0,0,0,0.28);
            transform-origin: center;
            animation: heroPop 900ms cubic-bezier(.2,.9,.2,1) both;
        }
        @keyframes heroPop { from { transform: scale(0.9) translateY(6px); opacity:0 } to { transform: scale(1) translateY(0); opacity:1 } }

        /* animated CTA */
        #page1 button#nextBtn1 {
            font-size: 18px;
            padding: 14px 28px;
            border-radius: 34px;
            background: linear-gradient(90deg,#ffe28a,#ff9ab3);
            box-shadow: 0 14px 40px rgba(255,110,150,0.16);
            transform-origin: center;
            animation: ctaGlow 2.2s ease-in-out infinite;
        }
        @keyframes ctaGlow {
            0% { transform: translateY(0) scale(1); box-shadow: 0 10px 28px rgba(255,110,150,0.12); }
            50% { transform: translateY(-6px) scale(1.02); box-shadow: 0 20px 48px rgba(255,110,150,0.18); }
            100% { transform: translateY(0) scale(1); box-shadow: 0 10px 28px rgba(255,110,150,0.12); }
        }

        /* decorative sparkles for the intro */
        #page1 .intro-decor { position: absolute; inset: 0; pointer-events: none; z-index: 50; }
        #page1 .intro-decor span {
            position: absolute; width: 12px; height: 12px; border-radius: 50%; background: rgba(255,255,255,0.9);
            mix-blend-mode: screen; opacity: 0.9; transform: scale(0.9);
            box-shadow: 0 6px 18px rgba(255,170,200,0.18);
            animation: sparkle 3.2s linear infinite;
        }
        #page1 .intro-decor span.s1 { left: 12%; top: 26%; animation-delay: 0s; }
        #page1 .intro-decor span.s2 { left: 22%; top: 54%; animation-delay: 0.4s; }
        #page1 .intro-decor span.s3 { left: 72%; top: 18%; animation-delay: 0.9s; }
        #page1 .intro-decor span.s4 { left: 82%; top: 50%; animation-delay: 1.6s; }
        @keyframes sparkle { 0% { transform: translateY(0) scale(0.8); opacity:0 } 40% { opacity:1; transform: translateY(-6px) scale(1.1);} 100% { transform: translateY(-40px) scale(0.6); opacity:0 } }

        /* Song page styles */
        .song-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            max-width: 920px;
            margin: 0 auto;
            padding: 18px;
            background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.35), inset 0 1px 0 rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.06);
            backdrop-filter: blur(8px) saturate(120%);
        }
        .song-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 10px;
            width: 45%;
            max-width: 200px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        audio {
            width: 100%;
            margin-top: 5px;
        }
        /* New compact list styles */
        .song-list {
            width: 100%;
            display: flex;
            flex-direction: column;
            gap: 8px;
            align-items: stretch;
        }
        /* Shared player UI placed at left of the song list */
        .shared-player {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 8px;
            justify-content: flex-start;
        }
        .shared-player .play-btn {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: linear-gradient(180deg,#ff9ab3,#ff6f91);
            border: 1px solid rgba(255,255,255,0.12);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            cursor: pointer;
            box-shadow: 0 8px 22px rgba(0,0,0,0.28);
        }
        .shared-player .now-playing {
            text-align: left;
            font-size: 14px;
            opacity: 0.95;
        }
        .song-row {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 10px;
            background: rgba(255,255,255,0.06);
            border-radius: 10px;
        }
        .song-row.active-row { background: linear-gradient(90deg, rgba(255,255,255,0.06), rgba(255,255,255,0.03)); box-shadow: inset 0 0 0 1px rgba(255,255,255,0.02); }
        .song-row .rank {
            width: 28px;
            text-align: center;
            font-weight: 700;
            color: rgba(255,255,255,0.95);
            opacity: 0.95;
            text-shadow: 0 2px 6px rgba(0,0,0,0.25);
        }
        .song-row .thumb {
            width: 44px;
            height: 44px;
            object-fit: cover;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.35);
            border: 1px solid rgba(255,255,255,0.06);
        }
    .song-row .meta { flex: 1; text-align: left; }
        .song-row .meta .title { font-size: 16px; font-weight: 600; font-family: 'Roboto Slab', serif; color: #fff; text-shadow: 0 2px 6px rgba(0,0,0,0.45); -webkit-text-stroke: 0.4px rgba(0,0,0,0.18); }
        .song-row .meta .artist { font-size: 13px; opacity: 0.9; margin-top: 2px; font-family: 'Poppins', sans-serif; color: rgba(255,255,255,0.9); }
    /* hide per-row native controls when using shared player; keep for fallback if JS disabled */
    .mini-audio { width: 72px; height: 28px; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.35)); }
    .no-js-hide .mini-audio { display: none; }

        /* Hidden message */
        #secretMessage {
            position: fixed;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(90deg, rgba(255,255,255,0.18), rgba(255,255,255,0.02));
            padding: 12px 20px;
            border-radius: 25px;
            color: #fff;
            font-size: 18px;
            backdrop-filter: blur(8px);
            display: none;
            animation: fadeIn 1s ease;
            box-shadow: 0 10px 30px rgba(0,0,0,0.45);
            -webkit-text-stroke: 0.3px rgba(0,0,0,0.12);
            z-index: 9001;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* üì± Mobile-friendly adjustments */
        @media (max-width: 600px) {
            h1 { font-size: 22px; }
            h2 { font-size: 18px; }
            p { font-size: 15px; }
            img { max-width: 95%; }
            button {
                font-size: 14px;
                padding: 10px 18px;
            }
            .song-card {
                width: 75%;
                max-width: 320px;
                padding: 4px;
                border-radius: 12px;
            }
            .song-card h3 { font-size: 16px; margin: 6px 0; }
            .song-card p { font-size: 13px; margin: 4px 0; }
            .song-card audio { height: 36px; }
            /* Adjust list rows on mobile */
            .song-list { gap: 6px; }
            .song-row { padding: 6px 8px; }
            .song-row .rank { width: 22px; font-size: 14px; }
            .song-row .thumb { width: 40px; height: 40px; }
            .song-row .meta .title { font-size: 15px; }
            .mini-audio { width: 64px; height: 26px; }
            .song-container { max-width: 95%; padding: 10px; border-radius: 12px; }
        }
    </style>
</head>
<body>

    <!-- Floating GIFs -->
    <div class="floating-gifs">
        <img src="images/1.gif" class="gif gif1" alt="Cake GIF">
        <img src="images/2.gif" class="gif gif2" alt="Confetti GIF">
        <img src="images/3.gif" class="gif gif3" alt="Balloons GIF">
    </div>

    <!-- Secret message -->
    <div id="secretMessage">üíñ I Love You üíñ</div>

    <!-- Pages -->
    <!-- NEW: Intro / Get Ready page -->
    <div class="page active" id="page1">
        <h1 style="font-size:48px; letter-spacing:1px;">Get ready for a surprise üéâ</h1>
        <h2 style="font-size:20px; opacity:0.95; margin-top:8px;">Close your eyes, and count to three...</h2>
        <p style="max-width:420px; margin-top:14px; opacity:0.95;">I made something special just for you ‚Äî tap next when you're ready to begin!</p>
        <button id="nextBtn1">Let‚Äôs go ‚ú®</button>
    </div>
   
    <!-- reinstated: Kuchupuchu / personal greeting as page2 -->
    <div class="page" id="page2">
        <h1>üéÇ Happy Birthday Vaishnavi üíñ</h1>
        <h2>You‚Äôre my kuchupuchu ‚òÄÔ∏è</h2>
        <img src="images/photo4.jpg" alt="Vaishnavi">
        <button id="nextBtn2">Next ‚û°Ô∏è</button>
    </div>

    <div class="page" id="page3">
        <h1>üíå Note by Heart üíå</h1>
        <p style="max-width:320px;">Babu tere bina sab boring lagta hai , you are the most wonderful person in my life.</p>
        <img src="images/notephoto.gif" alt="Note Photo">
        <button id="nextBtn3">Next ‚û°Ô∏è</button>
    </div>

    <div class="page" id="page4">
        <h1>üíå Kissi For you Moti üíå</h1>
        <p style="max-width:320px;">üòò</p>
        <img src="images/yourGIF.gif" alt="GIF for you">
        <button id="nextBtn4">Next ‚û°Ô∏è</button>
    </div>

    <div class="page" id="page5">
        <h1> Songs I Dedicate to You üéµ</h1>
        
        <div class="song-container no-js-hide">
            <!-- shared player sits above the list -->
            <div class="shared-player" id="sharedPlayer" aria-hidden="false">
                <div class="play-btn" id="masterPlay" title="Play/Pause">‚ñ∂</div>
                <div class="now-playing" id="nowPlaying">Select a song to play</div>
            </div>
            <div class="song-list" id="songList">
                <div class="song-row">
                    <div class="rank">1</div>
                    <img class="thumb" src="images/thumb1.jpg" alt="thumb1">
                    <div class="meta">
                        <div class="title">Iktara</div>
                        <div class="artist">Amit Trivedi, K... </div>
                    </div>
                    <audio class="mini-audio" controls src="music/song1.mp3"></audio>
                </div>
                <div class="song-row active-row">
                    <div class="rank">2</div>
                    <img class="thumb" src="images/thumb2.jpg" alt="thumb2">
                    <div class="meta">
                        <div class="title">Mere Sohneya</div>
                        <div class="artist">Sachet Tandon, P...</div>
                    </div>
                    <audio class="mini-audio" controls src="music/song2.mp3"></audio>
                </div>
                <div class="song-row">
                    <div class="rank">3</div>
                    <img class="thumb" src="images/thumb3.jpg" alt="thumb3">
                    <div class="meta">
                        <div class="title">Dhadak - Title ...</div>
                        <div class="artist">Ajay Gogavale, S...</div>
                    </div>
                    <audio class="mini-audio" controls src="music/song3.mp3"></audio>
                </div>
                <div class="song-row">
                    <div class="rank">4</div>
                    <img class="thumb" src="images/thumb4.jpg" alt="thumb4">
                    <div class="meta">
                        <div class="title">Dil Dardeh</div>
                        <div class="artist">Sukha, The Proph...</div>
                    </div>
                    <audio class="mini-audio" controls src="music/song4.mp3"></audio>
                </div>
                <div class="song-row">
                    <div class="rank">5</div>
                    <img class="thumb" src="images/thumb5.jpg" alt="thumb5">
                    <div class="meta">
                        <div class="title">Ishq</div>
                        <div class="artist">Faheem Abdu...</div>
                    </div>
                    <audio class="mini-audio" controls src="music/song5.mp3"></audio>
                </div>
            </div>
        </div>
        
        <button id="nextBtn5">Next ‚û°Ô∏è</button>
    </div>

    <div class="page" id="page6">
        <h1>üéâ Surprise! üéâ</h1>
        <img src="images/photo3.gif" alt="Surprise">
        <h2>Happy Birthday, my love üíñ</h2>
        <p>That's the end of the surprise so far!</p>
        <button id="restartBtn">Start Over ‚§¥Ô∏è</button>
    </div>

    <!-- background music removed per request -->

    <script>
    // Page switching
    let current = 1;
    const total = 6;
        function showPage(n) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById('page' + n).classList.add('active');
        }
        function nextPage() {
            current = current + 1 > total ? total : current + 1;
            showPage(current);
        }

    document.getElementById('nextBtn1').onclick = function() { nextPage(); };
    document.getElementById('nextBtn2').onclick = nextPage;
    document.getElementById('nextBtn3').onclick = nextPage;
    document.getElementById('nextBtn4').onclick = nextPage;
    // newly added navigation for the songs -> surprise transition
    const maybeNext5 = document.getElementById('nextBtn5');
    if (maybeNext5) maybeNext5.onclick = nextPage;
        // Restart button on last page -> go to first page
        const restartBtn = document.getElementById('restartBtn');
        if (restartBtn) {
            restartBtn.addEventListener('click', () => {
                current = 1;
                showPage(1);
            });
        }
        // Background music removed ‚Äî autoplay and unmute UI removed.

        // Floating hearts
        function createHeart() {
            const heart = document.createElement('div');
            heart.className = 'heart';
            heart.textContent = ['üíñ','üíû','üíó','üíì','‚ú®'][Math.floor(Math.random()*5)];
            heart.style.left = Math.random() * 100 + 'vw';
            heart.style.animationDuration = (3 + Math.random() * 2) + 's';
            document.body.appendChild(heart);
            setTimeout(() => heart.remove(), 4000);
        }
        setInterval(createHeart, 800);

        // Hidden message trigger (triple tap anywhere on document)
        let tapCount = 0;
        document.addEventListener('click', () => {
            tapCount++;
            if (tapCount === 3) {
                const msg = document.getElementById('secretMessage');
                msg.classList.add('show');
                setTimeout(() => msg.classList.remove('show'), 4000);
                tapCount = 0;
            }
            setTimeout(() => tapCount = 0, 1500);
        });

        // Floating GIFs ‚Äî random-direction motion using requestAnimationFrame
        (function() {
            const gifs = Array.from(document.querySelectorAll('.floating-gifs img'));
            if (!gifs.length) return;
            const state = [];
            const vw = () => Math.max(document.documentElement.clientWidth || 0, window.innerWidth || 0);
            const vh = () => Math.max(document.documentElement.clientHeight || 0, window.innerHeight || 0);

            // initialize each gif with random position and velocity
            function init() {
                const W = vw();
                const H = vh();
                gifs.forEach((el, i) => {
                    // reduce CSS animation interference: keep bob only
                    el.style.animation = 'float 4s ease-in-out infinite';
                    el.style.willChange = 'transform, left, top';
                    const w = el.width || 80;
                    // start slightly off-screen below
                    const left = Math.random() * (W - w);
                    const top = H + (50 + Math.random() * 200);
                    el.style.left = left + 'px';
                    el.style.top = top + 'px';
                    el.style.position = 'fixed';

                    // velocities in px per ms
                    const speed = 0.04 + Math.random() * 0.12; // base speed
                    const angle = - (0.5 + Math.random() * 1.0) * Math.PI/2 + (Math.random()-0.5); // generally upwards
                    const vx = Math.cos(angle) * speed;
                    const vy = Math.sin(angle) * speed;
                    state[i] = { el, x: left, y: top, vx, vy, wobble: Math.random()*0.002 + 0.0005, angle: (Math.random()-0.5)*6 };
                });
            }

            let last = performance.now();
            function tick(now) {
                const dt = Math.min(40, now - last); // cap delta for stability
                last = now;
                const W = vw();
                const H = vh();
                state.forEach(s => {
                    if (!s) return;
                    // small random jitter to change direction slowly
                    s.vx += (Math.random() - 0.5) * s.wobble * dt;
                    s.vy += (Math.random() - 0.5) * s.wobble * dt;
                    // limit speeds
                    const vmax = 0.25;
                    s.vx = Math.max(-vmax, Math.min(vmax, s.vx));
                    s.vy = Math.max(-vmax, Math.min(vmax, s.vy));
                    s.x += s.vx * dt;
                    s.y += s.vy * dt;

                    // gentle horizontal wrap-around
                    if (s.x < -100) s.x = W + 100;
                    if (s.x > W + 100) s.x = -100;

                    // if completely off top, reset to bottom
                    if (s.y < -200) {
                        s.y = H + (40 + Math.random()*160);
                        s.x = Math.random() * (W - (s.el.width||80));
                        // new upward velocity
                        const speed = 0.05 + Math.random() * 0.12;
                        const angle = - (0.5 + Math.random() * 1.0) * Math.PI/2 + (Math.random()-0.5);
                        s.vx = Math.cos(angle) * speed;
                        s.vy = Math.sin(angle) * speed;
                    }

                    // apply styles
                    s.el.style.left = (s.x) + 'px';
                    s.el.style.top = (s.y) + 'px';
                    // subtle rotation based on vx
                    const rot = s.vx * 120;
                    s.el.style.transform = `rotate(${rot}deg)`;
                });
                requestAnimationFrame(tick);
            }

            window.addEventListener('resize', init);
            init();
            requestAnimationFrame(tick);
        })();

        // Shared player: single audio element to play selected song rows
        (function() {
            const songListEl = document.getElementById('songList');
            const rows = Array.from(document.querySelectorAll('.song-row'));
            const masterPlay = document.getElementById('masterPlay');
            const nowPlaying = document.getElementById('nowPlaying');
            const bgMusic = document.getElementById('bg-music');

            // if JS is running, hide per-row native controls (we'll keep them for noscript fallback)
            document.documentElement.classList.remove('no-js-hide');
            // create a single audio element used by the shared player
            const player = document.createElement('audio');
            player.id = 'sharedAudio';
            player.preload = 'auto';
            player.style.display = 'none';
            document.body.appendChild(player);

            let currentIndex = -1;

            function selectRow(index) {
                if (currentIndex === index) return;
                rows.forEach((r, i) => r.classList.toggle('active-row', i === index));
                const selected = rows[index];
                const src = selected.querySelector('.mini-audio')?.getAttribute('src') || '';
                const title = selected.querySelector('.meta .title')?.textContent || 'Unknown';
                const artist = selected.querySelector('.meta .artist')?.textContent || '';
                nowPlaying.textContent = title + (artist ? (' ‚Äî ' + artist) : '');
                player.src = src;
                player.currentTime = 0;
                currentIndex = index;
            }

            // clicking a row selects it and plays
            rows.forEach((r, i) => {
                r.style.cursor = 'pointer';
                r.addEventListener('click', (ev) => {
                    selectRow(i);
                    playShared();
                });
            });

            // background music removed ‚Äî no pause/resume interactions

            function playShared() {
                if (!player.src) {
                    // nothing selected; try to select first
                    if (rows.length) selectRow(0);
                }
                player.play().then(() => {
                    masterPlay.textContent = '‚è∏';
                }).catch(() => {
                    // user gesture required in some browsers; prompt
                    // autoplay blocked ‚Äî nothing to do (no background music UI)
                });
            }
            function pauseShared() {
                player.pause();
                masterPlay.textContent = '‚ñ∂';
            }

            masterPlay.addEventListener('click', () => {
                if (player.paused) playShared(); else pauseShared();
            });

            // when song ends, reset button and resume bg music
            player.addEventListener('ended', () => {
                masterPlay.textContent = '‚ñ∂';
                resumeBgMusicIfNeeded();
            });

            // if user manually pauses the shared player, resume bg
            player.addEventListener('pause', () => {
                if (player.currentTime > 0 && !player.ended) {
                    resumeBgMusicIfNeeded();
                }
            });

            // expose selectRow for potential future use
            window.selectSongRow = selectRow;
        })();
    </script>
</body>
</html>
